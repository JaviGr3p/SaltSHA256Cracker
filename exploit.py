import hashlib
import binascii
from hashlib import pbkdf2_hmac
import sys
import signal
import time

def saliendo(signal_received, frame):
    print("\n[⚠️] Saliendo... Interrupción detectada. ")
    sys.exit(0)

signal.signal(signal.SIGINT, saliendo)

print("=" * 50)
print("🔓 Salt SHA256 Cracker - J4Gr3p")
print("🚀 Descifrando hash con diccionario...")
print("=" * 50)

# Definición de parámetros
salt = binascii.unhexlify("AQUI TU HASH SALT")
hash_target = binascii.unhexlify("HASH")
iterations = 50000
wordlist_path = "/usr/share/wordlists/rockyou.txt"

try:
    with open(wordlist_path, "r", encoding="latin-1") as f:
        total_passwords = sum(1 for _ in f)

    print(f"📂 Diccionario cargado: {total_passwords} claves a analizar.\n")

    with open(wordlist_path, "r", encoding="latin-1") as f:
        for i, password in enumerate(f, 1):
            password = password.strip()
            hash_candidate = pbkdf2_hmac('sha256', password.encode(), salt, iterations, 50)

            progress = int((i / total_passwords) * 50)  # Escalamos a 50 caracteres
            sys.stdout.write(f"\r🔍 Progreso: [{'#' * progress}{'-' * (50 - progress)}] {i}/{total_passwords}")
            sys.stdout.flush()

            if hash_candidate == hash_target:
                print(f"\n\n[✅] ¡Contraseña encontrada! 🚀")
                print(f"[+] Password: {password}")
                sys.exit(0)

    print("\n[❌] No se encontró la contraseña en la lista.")
except FileNotFoundError:
    print(f"[❌] No se encontró el archivo: {wordlist_path}")
except Exception as e:
    print(f"[⚠️] Error inesperado: {e}")
